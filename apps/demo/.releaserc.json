{
  "branches": ["main", { "name": "develop", "prerelease": true }],
  "tagFormat": "demo-v${version}",
  "plugins": [
    [
      "@semantic-release/commit-analyzer",
      {
        "preset": "conventionalcommits",
        "parserOpts": {
          "maxSubjectLength": 200
        }
      }
    ],
    ["@semantic-release/release-notes-generator", { "preset": "conventionalcommits" }],
    [
      "semantic-release-replace-plugin",
      {
        "replacements": [
          {
            "files": ["apps/demo/pyproject.toml"],
            "from": "version = \".*\"",
            "to": "version = \"${nextRelease.version}\""
          },
          {
            "files": ["apps/demo/__init__.py"],
            "from": "__version__ = \".*\"",
            "to": "__version__ = \"${nextRelease.version}\""
          }
        ]
      }
    ],
    [
      "semantic-release-yaml",
      {
        "commands": [
          {
            "file": "../../charts/ollyscale-demos/values.yaml",
            "selector": "frontend.image.tag",
            "value": "v${nextRelease.version}"
          },
          {
            "file": "../../charts/ollyscale-demos/values.yaml",
            "selector": "backend.image.tag",
            "value": "v${nextRelease.version}"
          }
        ]
      }
    ],
    [
      "@codedependant/semantic-release-docker",
      {
        "dockerImage": "demo",
        "dockerRegistry": "ghcr.io",
        "dockerProject": "ryanfaircloth/ollyscale",
        "dockerFile": "Dockerfile",
        "dockerContext": ".",
        "dockerTags": ["{{version}}", "develop", "latest", "{{major}}", "{{major}}.{{minor}}"],
        "dockerPublish": true,
        "quiet": false
      }
    ],
    [
      "@semantic-release/git",
      {
        "assets": ["apps/demo/pyproject.toml", "apps/demo/__init__.py", "charts/ollyscale-demos/values.yaml"],
        "message": "chore(demo): release v${nextRelease.version}"
      }
    ],
    "@semantic-release/github"
  ]
}
