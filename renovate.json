{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended", ":dependencyDashboard", ":semanticCommits"],
  "timezone": "America/New_York",
  "schedule": ["before 5am on Monday"],
  "enabledManagers": ["dockerfile", "docker-compose", "github-actions", "gomod", "npm", "pip_requirements"],
  "semanticCommits": "enabled",
  "commitMessagePrefix": "fix(deps)",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",
  "packageRules": [
    {
      "description": "Security updates are fix type with SECURITY in PR title",
      "matchPackagePatterns": ["*"],
      "vulnerabilityAlerts": {
        "enabled": true
      },
      "commitMessagePrefix": "fix(deps)",
      "commitMessageSuffix": "[SECURITY]"
    },
    {
      "description": "Major updates require approval and use feat! for breaking changes",
      "matchUpdateTypes": ["major"],
      "dependencyDashboardApproval": true,
      "commitMessagePrefix": "feat(deps)!",
      "labels": ["dependencies", "renovate", "breaking-change"]
    },
    {
      "description": "Group Python packages by app",
      "matchManagers": ["pip_requirements"],
      "matchFileNames": ["apps/ollyscale/**"],
      "groupName": "ollyscale Python dependencies"
    },
    {
      "description": "Group demo app dependencies separately",
      "matchManagers": ["pip_requirements"],
      "matchFileNames": ["apps/demo/**", "apps/ai-agent-demo/**"],
      "groupName": "demo apps Python dependencies"
    },
    {
      "description": "Group documentation dependencies",
      "matchManagers": ["pip_requirements"],
      "matchFileNames": ["docs/**"],
      "groupName": "documentation dependencies"
    },
    {
      "description": "OpAMP server Go dependencies",
      "matchManagers": ["gomod"],
      "matchFileNames": ["apps/opamp-server/**"],
      "groupName": "opamp-server Go dependencies"
    },
    {
      "description": "Group ollyscale-ui npm dependencies",
      "matchManagers": ["npm"],
      "matchFileNames": ["apps/ollyscale-ui/**"],
      "groupName": "ollyscale-ui npm dependencies"
    },
    {
      "description": "Group all Docker base images",
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "Docker base images"
    },
    {
      "description": "Separate major Docker updates",
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["major"],
      "dependencyDashboardApproval": true
    },
    {
      "description": "Pin Redis version (critical for data)",
      "matchPackageNames": ["redis"],
      "matchDatasources": ["docker"],
      "enabled": false
    },
    {
      "description": "Auto-merge non-major Python packages in dev apps",
      "matchManagers": ["pip_requirements"],
      "matchFileNames": ["apps/demo/**", "apps/ai-agent-demo/**"],
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "pr"
    }
  ],
  "digest": {
    "enabled": true,
    "dependencyDashboardApproval": true
  },
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security"]
  },
  "labels": ["dependencies", "renovate"]
}
